services:
  first:
    image: alpine:3.20
    command:
      [
        "sh",
        "-c",
        "echo FIRST LIST SERVICE && env | grep -E 'CONFIG_KEY|EXAMPLE_KEY|DEMO_VAR'",
      ]
    environment: &envlist
      - CONFIG_KEY=foo
      - EXAMPLE_KEY=bar
      - DEMO_VAR=baz
  second:
    image: alpine:3.20
    command:
      [
        "sh",
        "-c",
        "echo SECOND LIST SERVICE && env | grep -E 'CONFIG_KEY|EXAMPLE_KEY|DEMO_VAR'",
      ]
    environment: *envlist
    depends_on:
      - first

  third:
    image: alpine:3.20
    command:
      [
        "sh",
        "-c",
        "echo DICT SERVICE && env | grep -E 'FOO|ZOT|YET_ANOTHER'",
      ]
    environment: &envdict
      FOO: BAR
      ZOT: QUIX
    depends_on:
      - second

  fourth:
    image: alpine:3.20
    command:
      [
        "sh",
        "-c",
        "echo DICT SERVICE EXTENDIDO && env | grep -E 'FOO|ZOT|YET_ANOTHER'",
      ]
    environment:
      <<: *envdict
      YET_ANOTHER: VARIABLE
    depends_on:
      - third
